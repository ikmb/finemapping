profiles {
    standard {
        executor.name = "slurm"
        executor.queueSize = 150
        process.executor = "slurm"
        process.queue = "all"
    }
}

singularity {
	enabled = true
	runOptions= "-B /work_ifs/sukmb465"
	cacheDir = "/work_ifs/sukmb465/NXF/cache"
}

process {
	cpus = 	{	check_max( 1 * task.attempt, 'cpus' ) }
	memory ={	check_max( 8.GB * task.attempt, 'memory') }
	time =	{	check_max( 2.h * task.attempt, 'time') }
	
	withLabel: humann {
	cpus = { check_max( 8 * task.attempt, 'cpus') }
	memory = { check_max( 32.GB * task.attempt, 'memory') }
	time = { check_max( 10.h * task.attempt, 'time') }
	}	
	withLabel: metaphlan {
	cpus = { check_max( 8 * task.attempt, 'cpus') }
	memory = { check_max( 16.GB * task.attempt, 'memory') }
	time = { check_max( 10.h * task.attempt, 'time') }
	}
	withLabel: bowtie2 {
	cpus = { check_max( 8 * task.attempt, 'cpus') }
	memory = { check_max( 16.GB * task.attempt, 'memory') }
	time = { check_max( 10.h * task.attempt, 'time') }
	}
}

